{% extends 'base.html' %}
{% load static %}
{% load humanize %}

{% block title %} Fil d'actualité {% endblock title %}

{% block style %}
<link rel="shortcut icon" href=" {% static 'components/img/linkedin-cust.svg' %} " type="image/x-icon" />
<link rel="stylesheet" href=" {% static 'components/css/style.css' %}" />
<link rel="stylesheet" href=" {% static 'comments/css/style.css' %} " />
<link rel="stylesheet" href=" {% static 'post/css/style.css' %}" />
{% endblock style %}

{% block navbar %} {% include 'components/navbar2.html' %} {% endblock navbar %}


{% block content %}
<main class="main-list_post">
  <div class="container-left">
    {% include 'post/components/left.html' %}
  </div>


  <div class="container-main">
    {% include 'post/components/add_post.html' %}

    {% for post in posts %}
    <div class="container-all-post">
      {% include 'post/components/options.html' %}

      <div class="post-header">
        <a href="{% url 'profiles:profile' pseudo=post.author.profile.pseudo  %}">
          <div class="post-header-img">
            <img src="        
              {% if post.author.profile.img_profile %}
              {{ post.author.profile.img_profile.url }}
              {% else %}
              {% static 'profiles/img/default-img-profile.jpg' %}
              {% endif %}" />
          </div>
        </a>
        <div class="post-header-info">
          <strong><a href="{% url 'profiles:profile' pseudo=post.author.profile.pseudo  %}">{{post.author.first_name}}
              {{post.author.last_name}}</a></strong>
          <p>{{post.author.profile.bio}}</p>
          <p>{{post.date_created|naturaltime}}</p>
        </div>
      </div>

      <div class="post-text-content">
        <p>{{post.message|linebreaksbr}}</p>
      </div>

      {% if post.img %}
      <div class="post-img">
        <img src="{{post.img.url}}" alt="" />
      </div>
      {% endif %}

      <div class="post-footer">
        {% include 'post/components/count-likes-comments.html' %}
        <hr />
        <div class="box-action-icon">
          {% include 'post/components/like-form-btn.html' %}
          <button href="#" class="action-icon box-comment btn-container-comment-toggle" id="{{post.id}}">
            <img src="{% static 'post/img/comment.svg' %}" alt="" id="{{post.id}}" />
            <span id="{{post.id}}">Commenter</span>
          </button>
          <button href="#" class="action-icon box-share">
            <img src="{% static 'post/img/share.svg' %}" alt="" />
            <span>Partager</span>
          </button>
        </div>
      </div>

      {% include 'comments/include/comment.html' %}
    </div>
    {% endfor %}
  </div>


  <div class="container-right">
    <ul class="container-aside-1">
      <h4>Actualités</h4>
    </ul>
    <!-- <ul class="container-aside-2">
      
    </ul> -->
  </div>
</main>
{% endblock content %}


{% comment %}
{% block footer %} {% include 'components/footer.html' %} {% endblock footer %}
{% endcomment %}

{% block js %}
<script type="text/javascript" src=" {% static 'components/js/index.js' %} "></script>
<script type="text/javascript" src=" {% static 'post/js/post_list.js' %} "></script>
<script type="text/javascript" src=" {% static 'post/js/ajax_like_post.js' %} "></script>
<script type="text/javascript" src=" {% static 'comments/js/comment_list.js' %} "></script>

<script type="text/javascript" src=" {% static 'post/js/api-news.js' %} "></script>


{% comment %}
{% include 'post/components/ajax_like_post.html' %}
{% include 'comments/include/ajax_comment.html' %}
{% endcomment %}

{% if post_form %}
<script>
  const previous_container_edit = document.querySelector(
    ".previous-new-add-post"
  );
  const previous_p_img_container_edit =
    document.querySelector(".previous-post-img");

  previous_container_edit.classList.remove("display-none");
  previous_container_edit.classList.add("display-block");

  previous_p_img_container_edit.classList.remove("display-none");
  previous_p_img_container_edit.classList.add("display-block");
</script>
{% else %}
<script>
  // Close image previous
  const close_previous_p_img_container = document.querySelector(".previous-post-img");
  const close_p_img = document.getElementById("previous-post-image");
  const closed_img_previous = document.getElementById("close-img-previous");

  closed_img_previous.addEventListener("click", (e) => {
    close_previous_p_img_container.classList.remove("display-none");
    close_previous_p_img_container.classList.remove("display-block");
    close_p_img.setAttribute("src", "");
  })
</script>
{% endif %}

{% endblock js %}